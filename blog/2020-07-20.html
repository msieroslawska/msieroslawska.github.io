<!DOCTYPE html><html lang="en"><head><link href="https://fonts.googleapis.com/css?family=DM+Sans:400,400i,700&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Space+Mono:400,400i,700&amp;display=swap" rel="stylesheet"/><title>How on Earth do I deploy next.js to github pages...?</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/0fcb03e38cacf77fc9b1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0fcb03e38cacf77fc9b1.css"/><link rel="preload" href="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/pages/blog/%5Bslug%5D.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.e84fa698c7ee940652bd.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.34684228d50c6c140f9e.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-d8f6cc11b1d0cf8a72db.js" as="script"/><link rel="preload" href="/_next/static/chunks/027ef1e68a8faeecdab18641e53b6a91610e6293.0edb937e2e191f7bf5bd.js" as="script"/></head><body><div id="__next"><div><section class="page-wrapper"><section class="sidebar"><nav class="nav"><div class="nav-link "><a>Home</a></div><div class="nav-link "><a>About</a></div><div class="nav-link "><a>Blog</a></div><div class="nav-link "><a>Codelogs</a></div><div class="nav-link "><a>Articles</a></div><div class="nav-link "><a>Projects</a></div><div class="nav-link "><a>TODO</a></div></nav><footer class="footer"><p>Powered by <a href="https://nextjs.org/">next.js</a> and <a href="https://pages.github.com/">Github Pages</a></p></footer></section><main class="page-section"><h1 class="page-header">How on Earth do I deploy next.js to github pages...?</h1><p>2020-07-20</p><p>Tags: next.js</p><section><h2>Jekyll</h2>
<p>When I initially decided to create a personal page, mostly to document my notes taken during my learning process, first and most popular result in the category of static page generators was Jekyll. I'm used to tinkering and tweaking and breaking the code, and in the end I got it running, but man, adjusting it to my needs was a real chore and the resulting mix of <code>md</code> and <code>html</code> was... an eyesore:</p>
<pre><code class="hljs language-javascript">---
---

<span class="hljs-comment">/* eslint object-curly-newline: ["error", { "multiline": true }] */</span>
<span class="hljs-comment">/* global document */</span>

<span class="hljs-keyword">let</span> postDay, postMonth, postYear;
<span class="hljs-keyword">let</span> posts = [];

{% <span class="hljs-keyword">for</span> log <span class="hljs-keyword">in</span> site.posts %}
  postDay = <span class="hljs-string">"{{ log.date | date: '%d' }}"</span>;
  postMonth = <span class="hljs-string">"{{log.date | date: '%m'}}"</span>
  postYear = <span class="hljs-string">"{{log.date | date: '%Y'}}"</span>
  posts.push(<span class="hljs-string">`<span class="hljs-subst">${postYear}</span>-<span class="hljs-subst">${postMonth}</span>-<span class="hljs-subst">${postDay}</span>`</span>);
{% endfor %}

<span class="hljs-keyword">const</span> MONTHS = [
  <span class="hljs-string">'December'</span>, <span class="hljs-string">'November'</span>, <span class="hljs-string">'October'</span>, <span class="hljs-string">'September'</span>, <span class="hljs-string">'August'</span>, <span class="hljs-string">'July'</span>, <span class="hljs-string">'June'</span>, <span class="hljs-string">'May'</span>, <span class="hljs-string">'April'</span>, <span class="hljs-string">'March'</span>, <span class="hljs-string">'February'</span>, <span class="hljs-string">'January'</span>];
  <span class="hljs-comment">// 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];</span>

<span class="hljs-keyword">const</span> createUrl = <span class="hljs-function">(<span class="hljs-params">{ day, month, year }</span>) =></span> {
  <span class="hljs-keyword">const</span> url = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'a'</span>);
  <span class="hljs-keyword">const</span> urlText = <span class="hljs-built_in">document</span>.createTextNode(day);
  url.appendChild(urlText);
  url.href = <span class="hljs-string">`{{ site.url }}/blog/codelogs/<span class="hljs-subst">${year}</span>-<span class="hljs-subst">${month}</span>-<span class="hljs-subst">${day}</span>-Codelog.html`</span>;
  <span class="hljs-keyword">return</span> url;
};

<span class="hljs-keyword">const</span> createCell = <span class="hljs-function">(<span class="hljs-params">{
  cellType = <span class="hljs-string">'td'</span>,
  className = <span class="hljs-string">''</span>,
  day = <span class="hljs-string">''</span>,
  isUrl = <span class="hljs-literal">false</span>,
  month = <span class="hljs-string">''</span>,
  row,
  text = <span class="hljs-string">''</span>,
  year = <span class="hljs-string">''</span>,
}</span>) =></span> {
  <span class="hljs-keyword">const</span> cell = <span class="hljs-built_in">document</span>.createElement(cellType);

  <span class="hljs-keyword">if</span> (isUrl) {
    cell.className = <span class="hljs-string">`<span class="hljs-subst">${className}</span> url`</span>;
    <span class="hljs-keyword">const</span> url = createUrl({ className, day, month, year });
    <span class="hljs-comment">// url.className = 'url';</span>
    cell.appendChild(url);
  } <span class="hljs-keyword">else</span> {
    cell.className = className;
    <span class="hljs-keyword">const</span> cellText = <span class="hljs-built_in">document</span>.createTextNode(text);
    cell.appendChild(cellText);
  }

  row.appendChild(cell);
};

<span class="hljs-keyword">const</span> getNumberOfDays = <span class="hljs-function">(<span class="hljs-params">{
  month,
  year = <span class="hljs-number">2019</span>
}</span>) =></span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-built_in">Number</span>(year), <span class="hljs-built_in">Number</span>(month) + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>).getDate();

<span class="hljs-keyword">const</span> createDayCell = <span class="hljs-function">(<span class="hljs-params">{ day, idx, row }</span>) =></span> {
  <span class="hljs-keyword">const</span> m = idx &#x3C; <span class="hljs-number">9</span> ? <span class="hljs-string">`0<span class="hljs-subst">${idx + <span class="hljs-number">1</span>}</span>`</span> : <span class="hljs-string">`<span class="hljs-subst">${idx + <span class="hljs-number">1</span>}</span>`</span>;
  <span class="hljs-keyword">const</span> d = day &#x3C; <span class="hljs-number">9</span> ? <span class="hljs-string">`0<span class="hljs-subst">${day + <span class="hljs-number">1</span>}</span>`</span> : <span class="hljs-string">`<span class="hljs-subst">${day + <span class="hljs-number">1</span>}</span>`</span>;
  <span class="hljs-keyword">const</span> isUrl = <span class="hljs-built_in">Boolean</span>(posts.indexOf(<span class="hljs-string">`2019-<span class="hljs-subst">${m}</span>-<span class="hljs-subst">${d}</span>`</span>) + <span class="hljs-number">1</span>);

  createCell({ <span class="hljs-attr">className</span>: <span class="hljs-string">'cell'</span>, <span class="hljs-attr">day</span>: d, isUrl, <span class="hljs-attr">month</span>: m, row, <span class="hljs-attr">text</span>: d, <span class="hljs-attr">year</span>: <span class="hljs-number">2019</span> });
};

<span class="hljs-keyword">const</span> generateCalendar = <span class="hljs-function">() =></span> {
  <span class="hljs-keyword">const</span> calendar = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'calendar-table'</span>);
  <span class="hljs-keyword">const</span> currentDate = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
  <span class="hljs-keyword">let</span> newRow;

  MONTHS.forEach(<span class="hljs-function">(<span class="hljs-params">monthName, i</span>) =></span> {
    <span class="hljs-keyword">const</span> idx = <span class="hljs-number">11</span> - i;
    <span class="hljs-keyword">if</span> (currentDate.getMonth() >= <span class="hljs-built_in">Number</span>(idx)) {
      <span class="hljs-keyword">const</span> monthHeader = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'h3'</span>);
      monthHeader.className = <span class="hljs-string">'month'</span>;
      <span class="hljs-keyword">const</span> monthText = <span class="hljs-built_in">document</span>.createTextNode(monthName)
      monthHeader.appendChild(monthText);
      calendar.appendChild(monthHeader);
      <span class="hljs-keyword">const</span> monthTable = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'table'</span>);
      calendar.appendChild(monthTable);

      <span class="hljs-keyword">let</span> isFirstDay = <span class="hljs-literal">true</span>;

      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'day'</span>, currentDate.getDay())

      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> day <span class="hljs-keyword">of</span> <span class="hljs-built_in">Array</span>(getNumberOfDays({ <span class="hljs-attr">month</span>: idx })).keys()) {
        <span class="hljs-keyword">if</span> (isFirstDay || day % <span class="hljs-number">7</span> === <span class="hljs-number">0</span>) {
          newRow = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'tr'</span>);
          newRow.className = <span class="hljs-string">'row'</span>;

          <span class="hljs-keyword">if</span> (currentDate.getMonth() === <span class="hljs-built_in">Number</span>(idx)) {
            <span class="hljs-keyword">if</span> (day &#x3C; currentDate.getDay()) {
              createDayCell({ day, idx, <span class="hljs-attr">row</span>: newRow });

              monthTable.appendChild(newRow);
              isFirstDay = <span class="hljs-literal">false</span>;
            }
          } <span class="hljs-keyword">else</span> {
            createDayCell({ day, idx, <span class="hljs-attr">row</span>: newRow });

            monthTable.appendChild(newRow);
            isFirstDay = <span class="hljs-literal">false</span>;
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (currentDate.getMonth() === <span class="hljs-built_in">Number</span>(idx)) {
            <span class="hljs-keyword">if</span> (day &#x3C; currentDate.getDay()) {
              createDayCell({ day, idx, <span class="hljs-attr">row</span>: newRow });
            }
          } <span class="hljs-keyword">else</span> {
            createDayCell({ day, idx, <span class="hljs-attr">row</span>: newRow });
          }
        }
      }
    }
  });
};

generateCalendar();</code></pre>
<p>Yeah... not the prettiest. In case you were wondering, this code was supposed to display a calendar with clickable cells on days when I posted something.</p>
<h2>Gatsby</h2>
<p>That's when I decided to move to a shinier engine, with something more modern. Yes! React! GraphQL! Yes! Yes!</p>
<p>...but wait a moment.</p>
<p>Yes, that was an overkill. I grew impatient while debugging GraphQL queries and never finished porting the website.</p>
<h2>Next.js</h2>
<p>Few months have passed. The idea of my poor, abandoned page covered in dust was like a thorn in my conscience, subtly poking me and reminding me of its existence. During these past months I got a new job, got comfortable with TypeScript working as a full-time dev, why not try again? Perhaps... something simple and yet customizable?</p>
<p>That's how I ended up with next.js.</p>
<p>Getting familiar with the build system was a breeze. Integrating markdown files and processing was a bit of a chore, but still manageable. After a weekend, I had a nice, simple page running on my localhost. The time had come to <strong>deploy</strong>!</p>
<p>Uh oh. How do I deploy?</p>
<p>Official docs recommend using Vercel. Ummmm, no. I haven't scratched my overcomplicated Gatsby approach only to make it tangled with 3rd party elements again.</p>
<p>There was plenty of tutorials how to deploy your <strong>project page</strong> under <em>xxxx.github.io/[project-name]</em>. But what about deploying to root directory of the domain, in order to deploy the website?</p>
<p>I took me another few hours of poking and proding, lots of searching and reading stackoverflow. In the end, the solution which worked for me is the following:</p>
<ol>
<li>Two repositories</li>
</ol>
<ul>
<li><em>main github.io repo</em></li>
<li><em>github.io-source</em></li>
</ul>
<ol start="2">
<li><em>github.io-source</em> hosts the source code of next.js with a nice <em>deploy</em> script in <code>package.json</code>:</li>
</ol>
<pre><code class="hljs language-javascript">rm -rf out/ &#x26;&#x26; next build &#x26;&#x26; next <span class="hljs-keyword">export</span> -o out &#x26;&#x26; touch out/.nojekyll &#x26;&#x26; cp -R out/ ../\[main-repo-folder\].github.io</code></pre>
<ol start="3">
<li><em>main github.io repo</em> has <strong>only</strong> files generated by the deploy script -- <code>_next</code> folder and pure <code>html</code>. The only thing remaining after running deploy from source repo is to commit and push changes in the main repo.</li>
</ol>
<p>It's not a perfect solution, yes. Are there better approaches? Perhaps. I was not able to find anything more elegant. Github pages are deploying the <strong>personal page</strong> (root domain) only from your <em>master</em> branch (and root directory), therefore <code>html</code> has to sit directly at root and I didn't want to have my source polluted by it.</p>
</section></main></section></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"blog":{"date":"2020-07-20","tags":["next.js"],"title":"How on Earth do I deploy next.js to github pages...?","content":"\u003ch2\u003eJekyll\u003c/h2\u003e\n\u003cp\u003eWhen I initially decided to create a personal page, mostly to document my notes taken during my learning process, first and most popular result in the category of static page generators was Jekyll. I'm used to tinkering and tweaking and breaking the code, and in the end I got it running, but man, adjusting it to my needs was a real chore and the resulting mix of \u003ccode\u003emd\u003c/code\u003e and \u003ccode\u003ehtml\u003c/code\u003e was... an eyesore:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e---\n---\n\n\u003cspan class=\"hljs-comment\"\u003e/* eslint object-curly-newline: [\"error\", { \"multiline\": true }] */\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e/* global document */\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e postDay, postMonth, postYear;\n\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e posts = [];\n\n{% \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e log \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e site.posts %}\n  postDay = \u003cspan class=\"hljs-string\"\u003e\"{{ log.date | date: '%d' }}\"\u003c/span\u003e;\n  postMonth = \u003cspan class=\"hljs-string\"\u003e\"{{log.date | date: '%m'}}\"\u003c/span\u003e\n  postYear = \u003cspan class=\"hljs-string\"\u003e\"{{log.date | date: '%Y'}}\"\u003c/span\u003e\n  posts.push(\u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${postYear}\u003c/span\u003e-\u003cspan class=\"hljs-subst\"\u003e${postMonth}\u003c/span\u003e-\u003cspan class=\"hljs-subst\"\u003e${postDay}\u003c/span\u003e`\u003c/span\u003e);\n{% endfor %}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e MONTHS = [\n  \u003cspan class=\"hljs-string\"\u003e'December'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'November'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'October'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'September'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'August'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'July'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'June'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'May'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'April'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'March'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'February'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'January'\u003c/span\u003e];\n  \u003cspan class=\"hljs-comment\"\u003e// 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e createUrl = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ day, month, year }\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e url = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createElement(\u003cspan class=\"hljs-string\"\u003e'a'\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e urlText = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createTextNode(day);\n  url.appendChild(urlText);\n  url.href = \u003cspan class=\"hljs-string\"\u003e`{{ site.url }}/blog/codelogs/\u003cspan class=\"hljs-subst\"\u003e${year}\u003c/span\u003e-\u003cspan class=\"hljs-subst\"\u003e${month}\u003c/span\u003e-\u003cspan class=\"hljs-subst\"\u003e${day}\u003c/span\u003e-Codelog.html`\u003c/span\u003e;\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e url;\n};\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e createCell = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{\n  cellType = \u003cspan class=\"hljs-string\"\u003e'td'\u003c/span\u003e,\n  className = \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n  day = \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n  isUrl = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e,\n  month = \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n  row,\n  text = \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n  year = \u003cspan class=\"hljs-string\"\u003e''\u003c/span\u003e,\n}\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e cell = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createElement(cellType);\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isUrl) {\n    cell.className = \u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${className}\u003c/span\u003e url`\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e url = createUrl({ className, day, month, year });\n    \u003cspan class=\"hljs-comment\"\u003e// url.className = 'url';\u003c/span\u003e\n    cell.appendChild(url);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    cell.className = className;\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e cellText = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createTextNode(text);\n    cell.appendChild(cellText);\n  }\n\n  row.appendChild(cell);\n};\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e getNumberOfDays = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{\n  month,\n  year = \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e\n}\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003eNumber\u003c/span\u003e(year), \u003cspan class=\"hljs-built_in\"\u003eNumber\u003c/span\u003e(month) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e).getDate();\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e createDayCell = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ day, idx, row }\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e m = idx \u0026#x3C; \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e ? \u003cspan class=\"hljs-string\"\u003e`0\u003cspan class=\"hljs-subst\"\u003e${idx + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e}\u003c/span\u003e`\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${idx + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e}\u003c/span\u003e`\u003c/span\u003e;\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e d = day \u0026#x3C; \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e ? \u003cspan class=\"hljs-string\"\u003e`0\u003cspan class=\"hljs-subst\"\u003e${day + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e}\u003c/span\u003e`\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${day + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e}\u003c/span\u003e`\u003c/span\u003e;\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e isUrl = \u003cspan class=\"hljs-built_in\"\u003eBoolean\u003c/span\u003e(posts.indexOf(\u003cspan class=\"hljs-string\"\u003e`2019-\u003cspan class=\"hljs-subst\"\u003e${m}\u003c/span\u003e-\u003cspan class=\"hljs-subst\"\u003e${d}\u003c/span\u003e`\u003c/span\u003e) + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e);\n\n  createCell({ \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'cell'\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eday\u003c/span\u003e: d, isUrl, \u003cspan class=\"hljs-attr\"\u003emonth\u003c/span\u003e: m, row, \u003cspan class=\"hljs-attr\"\u003etext\u003c/span\u003e: d, \u003cspan class=\"hljs-attr\"\u003eyear\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2019\u003c/span\u003e });\n};\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e generateCalendar = \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e calendar = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.getElementById(\u003cspan class=\"hljs-string\"\u003e'calendar-table'\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e currentDate = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e();\n  \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e newRow;\n\n  MONTHS.forEach(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003emonthName, i\u003c/span\u003e) =\u003e\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e idx = \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e - i;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (currentDate.getMonth() \u003e= \u003cspan class=\"hljs-built_in\"\u003eNumber\u003c/span\u003e(idx)) {\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e monthHeader = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createElement(\u003cspan class=\"hljs-string\"\u003e'h3'\u003c/span\u003e);\n      monthHeader.className = \u003cspan class=\"hljs-string\"\u003e'month'\u003c/span\u003e;\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e monthText = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createTextNode(monthName)\n      monthHeader.appendChild(monthText);\n      calendar.appendChild(monthHeader);\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e monthTable = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createElement(\u003cspan class=\"hljs-string\"\u003e'table'\u003c/span\u003e);\n      calendar.appendChild(monthTable);\n\n      \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e isFirstDay = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e;\n\n      \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-string\"\u003e'day'\u003c/span\u003e, currentDate.getDay())\n\n      \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e day \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eArray\u003c/span\u003e(getNumberOfDays({ \u003cspan class=\"hljs-attr\"\u003emonth\u003c/span\u003e: idx })).keys()) {\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isFirstDay || day % \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e === \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n          newRow = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createElement(\u003cspan class=\"hljs-string\"\u003e'tr'\u003c/span\u003e);\n          newRow.className = \u003cspan class=\"hljs-string\"\u003e'row'\u003c/span\u003e;\n\n          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (currentDate.getMonth() === \u003cspan class=\"hljs-built_in\"\u003eNumber\u003c/span\u003e(idx)) {\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (day \u0026#x3C; currentDate.getDay()) {\n              createDayCell({ day, idx, \u003cspan class=\"hljs-attr\"\u003erow\u003c/span\u003e: newRow });\n\n              monthTable.appendChild(newRow);\n              isFirstDay = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n            }\n          } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n            createDayCell({ day, idx, \u003cspan class=\"hljs-attr\"\u003erow\u003c/span\u003e: newRow });\n\n            monthTable.appendChild(newRow);\n            isFirstDay = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n          }\n        } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (currentDate.getMonth() === \u003cspan class=\"hljs-built_in\"\u003eNumber\u003c/span\u003e(idx)) {\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (day \u0026#x3C; currentDate.getDay()) {\n              createDayCell({ day, idx, \u003cspan class=\"hljs-attr\"\u003erow\u003c/span\u003e: newRow });\n            }\n          } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n            createDayCell({ day, idx, \u003cspan class=\"hljs-attr\"\u003erow\u003c/span\u003e: newRow });\n          }\n        }\n      }\n    }\n  });\n};\n\ngenerateCalendar();\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYeah... not the prettiest. In case you were wondering, this code was supposed to display a calendar with clickable cells on days when I posted something.\u003c/p\u003e\n\u003ch2\u003eGatsby\u003c/h2\u003e\n\u003cp\u003eThat's when I decided to move to a shinier engine, with something more modern. Yes! React! GraphQL! Yes! Yes!\u003c/p\u003e\n\u003cp\u003e...but wait a moment.\u003c/p\u003e\n\u003cp\u003eYes, that was an overkill. I grew impatient while debugging GraphQL queries and never finished porting the website.\u003c/p\u003e\n\u003ch2\u003eNext.js\u003c/h2\u003e\n\u003cp\u003eFew months have passed. The idea of my poor, abandoned page covered in dust was like a thorn in my conscience, subtly poking me and reminding me of its existence. During these past months I got a new job, got comfortable with TypeScript working as a full-time dev, why not try again? Perhaps... something simple and yet customizable?\u003c/p\u003e\n\u003cp\u003eThat's how I ended up with next.js.\u003c/p\u003e\n\u003cp\u003eGetting familiar with the build system was a breeze. Integrating markdown files and processing was a bit of a chore, but still manageable. After a weekend, I had a nice, simple page running on my localhost. The time had come to \u003cstrong\u003edeploy\u003c/strong\u003e!\u003c/p\u003e\n\u003cp\u003eUh oh. How do I deploy?\u003c/p\u003e\n\u003cp\u003eOfficial docs recommend using Vercel. Ummmm, no. I haven't scratched my overcomplicated Gatsby approach only to make it tangled with 3rd party elements again.\u003c/p\u003e\n\u003cp\u003eThere was plenty of tutorials how to deploy your \u003cstrong\u003eproject page\u003c/strong\u003e under \u003cem\u003exxxx.github.io/[project-name]\u003c/em\u003e. But what about deploying to root directory of the domain, in order to deploy the website?\u003c/p\u003e\n\u003cp\u003eI took me another few hours of poking and proding, lots of searching and reading stackoverflow. In the end, the solution which worked for me is the following:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eTwo repositories\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003emain github.io repo\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003e\u003cem\u003egithub.io-source\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\u003cem\u003egithub.io-source\u003c/em\u003e hosts the source code of next.js with a nice \u003cem\u003edeploy\u003c/em\u003e script in \u003ccode\u003epackage.json\u003c/code\u003e:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003erm -rf out/ \u0026#x26;\u0026#x26; next build \u0026#x26;\u0026#x26; next \u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e -o out \u0026#x26;\u0026#x26; touch out/.nojekyll \u0026#x26;\u0026#x26; cp -R out/ ../\\[main-repo-folder\\].github.io\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e\u003cem\u003emain github.io repo\u003c/em\u003e has \u003cstrong\u003eonly\u003c/strong\u003e files generated by the deploy script -- \u003ccode\u003e_next\u003c/code\u003e folder and pure \u003ccode\u003ehtml\u003c/code\u003e. The only thing remaining after running deploy from source repo is to commit and push changes in the main repo.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eIt's not a perfect solution, yes. Are there better approaches? Perhaps. I was not able to find anything more elegant. Github pages are deploying the \u003cstrong\u003epersonal page\u003c/strong\u003e (root domain) only from your \u003cem\u003emaster\u003c/em\u003e branch (and root directory), therefore \u003ccode\u003ehtml\u003c/code\u003e has to sit directly at root and I didn't want to have my source polluted by it.\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"2020-07-20"},"buildId":"s7iXAZyb5Ha2u2j1r_k5s","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-2f74f7d9820760171318.js"></script><script async="" data-next-page="/_app" src="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/pages/_app.js"></script><script async="" data-next-page="/blog/[slug]" src="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/pages/blog/%5Bslug%5D.js"></script><script src="/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="/_next/static/chunks/framework.e84fa698c7ee940652bd.js" async=""></script><script src="/_next/static/chunks/commons.34684228d50c6c140f9e.js" async=""></script><script src="/_next/static/runtime/main-d8f6cc11b1d0cf8a72db.js" async=""></script><script src="/_next/static/chunks/027ef1e68a8faeecdab18641e53b6a91610e6293.0edb937e2e191f7bf5bd.js" async=""></script><script src="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/_buildManifest.js" async=""></script><script src="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/_ssgManifest.js" async=""></script></body></html>