<!DOCTYPE html><html lang="en"><head><link href="https://fonts.googleapis.com/css?family=DM+Sans:400,400i,700&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Space+Mono:400,400i,700&amp;display=swap" rel="stylesheet"/><title>All blog entries | Marta Sieros≈Çawska</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/0fcb03e38cacf77fc9b1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0fcb03e38cacf77fc9b1.css"/><link rel="preload" href="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/pages/blog.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.e84fa698c7ee940652bd.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.34684228d50c6c140f9e.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-d8f6cc11b1d0cf8a72db.js" as="script"/><link rel="preload" href="/_next/static/chunks/027ef1e68a8faeecdab18641e53b6a91610e6293.0edb937e2e191f7bf5bd.js" as="script"/></head><body><div id="__next"><div><section class="page-wrapper"><section class="sidebar"><nav class="nav"><div class="nav-link "><a>Home</a></div><div class="nav-link "><a>About</a></div><div class="nav-link current"><a>Blog</a></div><div class="nav-link "><a>Codelogs</a></div><div class="nav-link "><a>Articles</a></div><div class="nav-link "><a>Projects</a></div><div class="nav-link "><a>TODO</a></div></nav><footer class="footer"><p>Powered by <a href="https://nextjs.org/">next.js</a> and <a href="https://pages.github.com/">Github Pages</a></p></footer></section><main class="page-section"><h1 class="page-header">All blog entries</h1><ul><li><a href="/blog/2020-07-20">(2020-07-20) How on Earth do I deploy next.js to github pages...?</a></li></ul></main></section></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"blogs":[{"content":"\n## Jekyll\n\nWhen I initially decided to create a personal page, mostly to document my notes taken during my learning process, first and most popular result in the category of static page generators was Jekyll. I'm used to tinkering and tweaking and breaking the code, and in the end I got it running, but man, adjusting it to my needs was a real chore and the resulting mix of `md` and `html` was... an eyesore:\n\n```javascript\n---\n---\n\n/* eslint object-curly-newline: [\"error\", { \"multiline\": true }] */\n/* global document */\n\nlet postDay, postMonth, postYear;\nlet posts = [];\n\n{% for log in site.posts %}\n  postDay = \"{{ log.date | date: '%d' }}\";\n  postMonth = \"{{log.date | date: '%m'}}\"\n  postYear = \"{{log.date | date: '%Y'}}\"\n  posts.push(`${postYear}-${postMonth}-${postDay}`);\n{% endfor %}\n\nconst MONTHS = [\n  'December', 'November', 'October', 'September', 'August', 'July', 'June', 'May', 'April', 'March', 'February', 'January'];\n  // 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n\nconst createUrl = ({ day, month, year }) =\u003e {\n  const url = document.createElement('a');\n  const urlText = document.createTextNode(day);\n  url.appendChild(urlText);\n  url.href = `{{ site.url }}/blog/codelogs/${year}-${month}-${day}-Codelog.html`;\n  return url;\n};\n\nconst createCell = ({\n  cellType = 'td',\n  className = '',\n  day = '',\n  isUrl = false,\n  month = '',\n  row,\n  text = '',\n  year = '',\n}) =\u003e {\n  const cell = document.createElement(cellType);\n\n  if (isUrl) {\n    cell.className = `${className} url`;\n    const url = createUrl({ className, day, month, year });\n    // url.className = 'url';\n    cell.appendChild(url);\n  } else {\n    cell.className = className;\n    const cellText = document.createTextNode(text);\n    cell.appendChild(cellText);\n  }\n\n  row.appendChild(cell);\n};\n\nconst getNumberOfDays = ({\n  month,\n  year = 2019\n}) =\u003e new Date(Number(year), Number(month) + 1, 0).getDate();\n\nconst createDayCell = ({ day, idx, row }) =\u003e {\n  const m = idx \u003c 9 ? `0${idx + 1}` : `${idx + 1}`;\n  const d = day \u003c 9 ? `0${day + 1}` : `${day + 1}`;\n  const isUrl = Boolean(posts.indexOf(`2019-${m}-${d}`) + 1);\n\n  createCell({ className: 'cell', day: d, isUrl, month: m, row, text: d, year: 2019 });\n};\n\nconst generateCalendar = () =\u003e {\n  const calendar = document.getElementById('calendar-table');\n  const currentDate = new Date();\n  let newRow;\n\n  MONTHS.forEach((monthName, i) =\u003e {\n    const idx = 11 - i;\n    if (currentDate.getMonth() \u003e= Number(idx)) {\n      const monthHeader = document.createElement('h3');\n      monthHeader.className = 'month';\n      const monthText = document.createTextNode(monthName)\n      monthHeader.appendChild(monthText);\n      calendar.appendChild(monthHeader);\n      const monthTable = document.createElement('table');\n      calendar.appendChild(monthTable);\n\n      let isFirstDay = true;\n\n      console.log('day', currentDate.getDay())\n\n      for (const day of Array(getNumberOfDays({ month: idx })).keys()) {\n        if (isFirstDay || day % 7 === 0) {\n          newRow = document.createElement('tr');\n          newRow.className = 'row';\n\n          if (currentDate.getMonth() === Number(idx)) {\n            if (day \u003c currentDate.getDay()) {\n              createDayCell({ day, idx, row: newRow });\n\n              monthTable.appendChild(newRow);\n              isFirstDay = false;\n            }\n          } else {\n            createDayCell({ day, idx, row: newRow });\n\n            monthTable.appendChild(newRow);\n            isFirstDay = false;\n          }\n        } else {\n          if (currentDate.getMonth() === Number(idx)) {\n            if (day \u003c currentDate.getDay()) {\n              createDayCell({ day, idx, row: newRow });\n            }\n          } else {\n            createDayCell({ day, idx, row: newRow });\n          }\n        }\n      }\n    }\n  });\n};\n\ngenerateCalendar();\n```\n\nYeah... not the prettiest. In case you were wondering, this code was supposed to display a calendar with clickable cells on days when I posted something.\n\n## Gatsby\n\nThat's when I decided to move to a shinier engine, with something more modern. Yes! React! GraphQL! Yes! Yes!\n\n...but wait a moment.\n\nYes, that was an overkill. I grew impatient while debugging GraphQL queries and never finished porting the website.\n\n## Next.js\n\nFew months have passed. The idea of my poor, abandoned page covered in dust was like a thorn in my conscience, subtly poking me and reminding me of its existence. During these past months I got a new job, got comfortable with TypeScript working as a full-time dev, why not try again? Perhaps... something simple and yet customizable?\n\nThat's how I ended up with next.js.\n\nGetting familiar with the build system was a breeze. Integrating markdown files and processing was a bit of a chore, but still manageable. After a weekend, I had a nice, simple page running on my localhost. The time had come to **deploy**!\n\nUh oh. How do I deploy?\n\nOfficial docs recommend using Vercel. Ummmm, no. I haven't scratched my overcomplicated Gatsby approach only to make it tangled with 3rd party elements again.\n\nThere was plenty of tutorials how to deploy your **project page** under _xxxx.github.io/\\[project-name\\]_. But what about deploying to root directory of the domain, in order to deploy the website?\n\nI took me another few hours of poking and proding, lots of searching and reading stackoverflow. In the end, the solution which worked for me is the following:\n\n1. Two repositories\n\n- _main github.io repo_\n- _github.io-source_\n\n2. _github.io-source_ hosts the source code of next.js with a nice _deploy_ script in `package.json`:\n\n```javascript\nrm -rf out/ \u0026\u0026 next build \u0026\u0026 next export -o out \u0026\u0026 touch out/.nojekyll \u0026\u0026 cp -R out/ ../\\[main-repo-folder\\].github.io\n```\n\n3. _main github.io repo_ has **only** files generated by the deploy script -- `_next` folder and pure `html`. The only thing remaining after running deploy from source repo is to commit and push changes in the main repo.\n\nIt's not a perfect solution, yes. Are there better approaches? Perhaps. I was not able to find anything more elegant. Github pages are deploying the **personal page** (root domain) only from your _master_ branch (and root directory), therefore `html` has to sit directly at root and I didn't want to have my source polluted by it.\n","date":"2020-07-20","tags":["next.js"],"title":"How on Earth do I deploy next.js to github pages...?","slug":"2020-07-20"}]},"__N_SSG":true},"page":"/blog","query":{},"buildId":"s7iXAZyb5Ha2u2j1r_k5s","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-2f74f7d9820760171318.js"></script><script async="" data-next-page="/_app" src="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/pages/_app.js"></script><script async="" data-next-page="/blog" src="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/pages/blog.js"></script><script src="/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="/_next/static/chunks/framework.e84fa698c7ee940652bd.js" async=""></script><script src="/_next/static/chunks/commons.34684228d50c6c140f9e.js" async=""></script><script src="/_next/static/runtime/main-d8f6cc11b1d0cf8a72db.js" async=""></script><script src="/_next/static/chunks/027ef1e68a8faeecdab18641e53b6a91610e6293.0edb937e2e191f7bf5bd.js" async=""></script><script src="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/_buildManifest.js" async=""></script><script src="/_next/static/s7iXAZyb5Ha2u2j1r_k5s/_ssgManifest.js" async=""></script></body></html>